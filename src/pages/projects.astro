---
import Breadcrumbs from '@/components/Breadcrumbs.astro'
import PageHead from '@/components/PageHead.astro'
import ProjectCard from '@/components/ProjectCard.astro'
import Layout from '@/layouts/Layout.astro'
import { getAllProjects, groupProjectsByYear } from '@/lib/data-utils'

const projects = await getAllProjects()
const projectsByYear = groupProjectsByYear(projects)
const years = Object.keys(projectsByYear).sort(
  (a, b) => parseInt(b) - parseInt(a),
)
---

<Layout>
  <PageHead slot="head" title="Project" />
  <div class="mx-auto max-w-screen-md px-4 flex grow flex-col gap-y-6">
    <Breadcrumbs items={[{ label: 'Project', icon: 'lucide:briefcase' }]} />
  </div>

  <section
    class="mx-auto max-w-screen-md px-4 flex grow flex-col gap-y-6"
  >
    <div class="flex flex-col gap-y-8">
      {
        years.map((year) => (
          <section class="flex flex-col gap-y-4">
            <div class="font-medium">{year}</div>
            <ul class="flex flex-col gap-4">
              {projectsByYear[year].map((project) => (
                <li>
                  <ProjectCard project={project} />
                </li>
              ))}
            </ul>
          </section>
        ))
      }
    </div>
  </section>
</Layout>
